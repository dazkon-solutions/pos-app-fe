<!-- 
  Copyright (c) 2024 DAZKON SOLUTIONS (DAZKON PVT LTD)
  All rights reserved.  
  This code is proprietary to DAZKON SOLUTIONS. 
  Unauthorized use, reproduction, modification, distribution, or sale 
  without the explicit written permission of DAZKON SOLUTIONS is strictly prohibited.
  For inquiries, please contact: info@dazkonsolutions.com 
-->


<!-- Waiting -->
@if (isProcessing()) {
  <daz-waiting-overlay />
}
<!-- End of waiting -->

<!-- Header -->
<daz-dialog-header [config]="dialogHeaderConfig()"
                   [isProcessing]="isProcessing()" />
<!-- End of header -->

<!-- Content -->
<mat-dialog-content >
  <ng-container [ngTemplateOutlet]="FormTemplate" />

</mat-dialog-content>
<!-- End of content -->

<!-- Actions -->
<daz-dialog-form-actions [isCreateMode]="isCreateMode()"
                         [isEditable]="isFormEditable()"
                         [createPermission]="createPermission()"
                         [updatePermission]="updatePermission()"
                         (editablilityToggled)="onToggleEditability()"
                         (actionClicked)="onSubmit()" />
<!-- End of actions -->


<!-- Form template -->
<ng-template #FormTemplate >
  <form [formGroup]="form" >

    <!-- Name form field -->
    <mat-form-field class="form-field-width-full" >
      <mat-label > 
        {{ LocaleKeys.labels.forms.name | translate }}
      </mat-label>
      <input matInput 
              formControlName="name" 
              name="name"
              [readonly]="!isFormEditable()"
              [errorStateMatcher]="matcher" >
      @if (form.get('name')?.hasError('required')) {
        <mat-error>{{ LocaleKeys.errors.required | translate }}</mat-error>
      }
      @if (form.get('name')?.hasError('minlength')) {
        <mat-error>
          @let min = form.get('name')?.errors?.['minlength']?.requiredLength;
          {{ LocaleKeys.errors.minlength | translate: { min } }}
        </mat-error>
      }
      @if (form.get('name')?.hasError('maxlength')) {
        <mat-error>
          @let max = form.get('name')?.errors?.['maxlength']?.requiredLength;
          {{ LocaleKeys.errors.maxlength | translate: { max } }}
        </mat-error>
      }
    </mat-form-field>
    <!-- End of name form field -->

    <!-- Name local form field -->
    <mat-form-field class="form-field-width-full" >
      <mat-label > 
        {{ LocaleKeys.labels.forms.nameTranslated | translate }}
      </mat-label>
      <input matInput 
              formControlName="nameLocal" 
              name="nameLocal"
              [readonly]="!isFormEditable()"
              [errorStateMatcher]="matcher" >
      @if (form.get('nameLocal')?.hasError('minlength')) {
        <mat-error>
          @let min = form.get('nameLocal')?.errors?.['minlength']?.requiredLength;
          {{ LocaleKeys.errors.minlength | translate: { min } }}
        </mat-error>
      }
      @if (form.get('nameLocal')?.hasError('maxlength')) {
        <mat-error>
          @let max = form.get('nameLocal')?.errors?.['maxlength']?.requiredLength;
          {{ LocaleKeys.errors.maxlength | translate: { max } }}
        </mat-error>
      }
    </mat-form-field>
    <!-- End of name local form field -->

    <!-- Description form field -->
    <mat-form-field class="form-field-width-full" >
      <mat-label >
        {{ LocaleKeys.labels.forms.description | translate }}
      </mat-label>
      <textarea matInput 
                formControlName="description"
                name="description"
                [readonly]="!isFormEditable()"
                [errorStateMatcher]="matcher" >
      </textarea>
      @if (form.get('description')?.hasError('required')) {
        <mat-error>{{ LocaleKeys.errors.required | translate }}</mat-error>
      }
      @if (form.get('description')?.hasError('maxlength')) {
        <mat-error>
          @let max = form.get('description')?.errors?.['maxlength']?.requiredLength;
          {{ LocaleKeys.errors.maxlength | translate: { max } }}
        </mat-error>
      }
    </mat-form-field>
    <!-- End of description form field -->

    <!-- Description local form field -->
    <mat-form-field class="form-field-width-full" >
      <mat-label >
        {{ LocaleKeys.labels.forms.descriptionTranslated | translate }}
      </mat-label>
      <textarea matInput 
                formControlName="descriptionLocal"
                name="descriptionLocal"
                [readonly]="!isFormEditable()"
                [errorStateMatcher]="matcher" >
      </textarea>
      @if (form.get('descriptionLocal')?.hasError('maxlength')) {
        <mat-error>
          @let max = form.get('descriptionLocal')?.errors?.['maxlength']?.requiredLength;
          {{ LocaleKeys.errors.maxlength | translate: { max } }}
        </mat-error>
      }
    </mat-form-field>
    <!-- End of description local form field -->

  </form>
</ng-template>
<!-- End of form template -->