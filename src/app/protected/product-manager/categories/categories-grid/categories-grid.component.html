<!-- 
  Copyright (c) 2024 DAZKON SOLUTIONS (DAZKON PVT LTD)
  All rights reserved.  
  This code is proprietary to DAZKON SOLUTIONS. 
  Unauthorized use, reproduction, modification, distribution, or sale 
  without the explicit written permission of DAZKON SOLUTIONS is strictly prohibited.
  For inquiries, please contact: info@dazkonsolutions.com 
-->

@let dataSource = (dataSource$ | async) ?? [];
@let isLoading = isLoading$ | async;

<div class="grid" >
  @if (!isLoading) {
    @for (item of dataSource; track trackById($index, item)) {
      <ng-template [ngTemplateOutlet]="GridItemTemplate" 
                   [ngTemplateOutletContext]="{ item: item }" />
    }

  } @else {
    <!-- Loading animation -->
    @for (item of defaultLoadingItems; track item.id) {
      <daz-grid-item-skeleton [type]="GridItemSkeletonType.NAME_CARD" />
    }
    <!-- End of loading animation -->
  }
</div>

<!-- Grid item template -->
<ng-template #GridItemTemplate 
             let-item="item" >

  <mat-card class="grid-item card" appearance="outlined" >
    <!-- Content section -->
    <mat-card-content class="content" >
      <!-- Title section -->
      <div >
        <mat-card-title >{{ item.name }}</mat-card-title>
        <mat-card-subtitle >{{ item.weight }}</mat-card-subtitle>
      </div>
      <!-- End of title section -->

      <!-- Image section -->
      <img class="image" 
           alt="item image"
           [src]="item.photo" >
      <!-- End of image section -->
    </mat-card-content>
    <!-- End of content section -->

    <mat-card-actions >
      <!-- Action button area -->
      <div class="action-area" >
        <!-- Main button -->
        <daz-action-button [config$]="viewButton$" 
                           (buttonClicked)="buttonClicked($event, 
                                                          item)" />
        <!-- End of main button -->
        
        <!-- Secondary button -->
        <daz-action-button [config$]="deleteButton$"
                           (buttonClicked)="buttonClicked($event, 
                                                          item)" />
        <!-- End of secondary button -->
      </div>
      <!-- End of action button area -->

      <span class="spacer" ></span>

      <!-- Option button -->
      <button mat-icon-button
              [matTooltip]="LocaleKeys.tooltips.options | translate"
              [matMenuTriggerFor]="optionMenu" 
              [matMenuTriggerData]="{ item }" >
        <mat-icon svgIcon="expand-less-right" />
      </button>
      <!-- End of option button -->
    </mat-card-actions>
  </mat-card>

</ng-template>
<!-- End of grid item -->


<!-- Option menu -->
<mat-menu #optionMenu="matMenu" 
          xPosition="before" >
  <ng-template matMenuContent let-item="item" >
    <daz-action-button [config$]="deleteMenuItemButton$"
                       (buttonClicked)="buttonClicked($event, 
                                                      item)" />
  </ng-template>
</mat-menu>
<!-- End of option menu -->